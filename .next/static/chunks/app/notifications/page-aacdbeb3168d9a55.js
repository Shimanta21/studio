(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[173],{30285:(e,r,t)=>{"use strict";t.d(r,{$:()=>o,r:()=>d});var s=t(95155),a=t(12115),i=t(66634),n=t(74466),l=t(59434);let d=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=a.forwardRef((e,r)=>{let{className:t,variant:a,size:n,asChild:o=!1,...c}=e,u=o?i.DX:"button";return(0,s.jsx)(u,{className:(0,l.cn)(d({variant:a,size:n,className:t})),ref:r,...c})});o.displayName="Button"},55365:(e,r,t)=>{"use strict";t.d(r,{Fc:()=>d,TN:()=>c,XL:()=>o});var s=t(95155),a=t(12115),i=t(74466),n=t(59434);let l=(0,i.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=a.forwardRef((e,r)=>{let{className:t,variant:a,...i}=e;return(0,s.jsx)("div",{ref:r,role:"alert",className:(0,n.cn)(l({variant:a}),t),...i})});d.displayName="Alert";let o=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("h5",{ref:r,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",t),...a})});o.displayName="AlertTitle";let c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",t),...a})});c.displayName="AlertDescription"},66695:(e,r,t)=>{"use strict";t.d(r,{BT:()=>o,Wu:()=>c,ZB:()=>d,Zp:()=>n,aR:()=>l,wL:()=>u});var s=t(95155),a=t(12115),i=t(59434);let n=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})});n.displayName="Card";let l=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",t),...a})});l.displayName="CardHeader";let d=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});d.displayName="CardTitle";let o=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,i.cn)("text-sm text-muted-foreground",t),...a})});o.displayName="CardDescription";let c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,i.cn)("p-6 pt-0",t),...a})});c.displayName="CardContent";let u=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,i.cn)("flex items-center p-6 pt-0",t),...a})});u.displayName="CardFooter"},85212:(e,r,t)=>{"use strict";t.d(r,{default:()=>v});var s=t(95155),a=t(12115),i=t(67785),n=t(34477);let l=(0,n.createServerReference)("40877789207f2fd0bfa94b4b604b227aef05f5b287",n.callServer,void 0,n.findSourceMapURL,"generateExpiryNotification");var d=t(66695),o=t(30285),c=t(55365),u=t(36931),f=t(31949),m=t(74601),x=t(50172),g=t(83343),p=t(24386);function v(){let{products:e}=(0,i.n)(),[r,t]=(0,a.useState)({}),n=a.useMemo(()=>{let r=new Date;return e.filter(e=>{if(!e.expiryDate)return!1;let t=(0,g.H)(e.expiryDate),s=(0,p.c)(t,r);return s<=30&&s>=0}).sort((e,r)=>new Date(e.expiryDate).getTime()-new Date(r.expiryDate).getTime())},[e]),v=async e=>{if(e.expiryDate){t(r=>({...r,[e.id]:{isLoading:!0,message:null,error:null}}));try{let r=await l({productType:e.category,productName:e.name,quantity:e.stockInHand,expiryDate:e.expiryDate});t(t=>({...t,[e.id]:{isLoading:!1,message:r.notificationMessage,error:null}}))}catch(r){console.error(r),t(r=>({...r,[e.id]:{isLoading:!1,message:null,error:"Failed to generate notification."}}))}}};return(0,s.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(u.A,{className:"h-6 w-6"}),(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Expiry Notifications"})]}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Products that are expiring within the next 30 days are shown here."}),n.length>0?(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:n.map(e=>{let t=(0,p.c)((0,g.H)(e.expiryDate),new Date),a=r[e.id];return(0,s.jsxs)(d.Zp,{children:[(0,s.jsxs)(d.aR,{children:[(0,s.jsxs)(d.ZB,{className:"flex items-start justify-between",children:[e.name,(0,s.jsxs)("div",{className:"flex items-center text-sm font-medium text-destructive",children:[(0,s.jsx)(f.A,{className:"h-4 w-4 mr-1.5"}),t," days left"]})]}),(0,s.jsxs)(d.BT,{children:[e.stockInHand," items in stock. Expires on ",e.expiryDate,"."]})]}),(0,s.jsxs)(d.Wu,{children:[(null==a?void 0:a.message)&&(0,s.jsxs)(c.Fc,{variant:"default",className:"bg-primary/10",children:[(0,s.jsx)(m.A,{className:"h-4 w-4 text-primary"}),(0,s.jsx)(c.XL,{className:"text-primary",children:"Generated Reminder"}),(0,s.jsx)(c.TN,{children:a.message})]}),(null==a?void 0:a.error)&&(0,s.jsxs)(c.Fc,{variant:"destructive",children:[(0,s.jsx)(f.A,{className:"h-4 w-4"}),(0,s.jsx)(c.XL,{children:"Error"}),(0,s.jsx)(c.TN,{children:a.error})]})]}),(0,s.jsx)(d.wL,{children:(0,s.jsxs)(o.$,{onClick:()=>v(e),disabled:null==a?void 0:a.isLoading,className:"w-full",children:[(null==a?void 0:a.isLoading)?(0,s.jsx)(x.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(m.A,{className:"mr-2 h-4 w-4"}),"Generate Reminder"]})})]},e.id)})}):(0,s.jsx)(d.Zp,{className:"flex flex-col items-center justify-center py-20",children:(0,s.jsxs)(d.Wu,{className:"text-center",children:[(0,s.jsx)(u.A,{className:"h-12 w-12 mx-auto text-muted-foreground"}),(0,s.jsx)("h3",{className:"mt-4 text-lg font-medium",children:"All Clear!"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"No products are expiring soon."})]})})]})}},91587:(e,r,t)=>{Promise.resolve().then(t.bind(t,85212))}},e=>{var r=r=>e(e.s=r);e.O(0,[992,644,263,337,706,441,684,358],()=>r(91587)),_N_E=e.O()}]);