(()=>{var e={};e.id=117,e.ids=[117],e.modules={643:e=>{"use strict";e.exports=require("node:perf_hooks")},1708:e=>{"use strict";e.exports=require("node:process")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4573:e=>{"use strict";e.exports=require("node:buffer")},7252:e=>{"use strict";e.exports=require("express")},10029:(e,t,r)=>{"use strict";r.d(t,{default:()=>eS});var s=r(60687),a=r(43210),n=r.n(a),l=r(27605),i=r(63442),o=r(45880),c=r(30212),d=r(29523),u=r(44493),m=r(80942),p=r(89667),f=r(40988),h=r(26373),x=r(15079),v=r(6211),g=r(91821),b=/[\\\/_+.#"@\[\(\{&]/,y=/[\\\/_+.#"@\[\(\{&]/g,j=/[\s-]/,w=/[\s-]/g;function N(e){return e.toLowerCase().replace(w," ")}var k=r(10991),q=r(3416),S=r(96963),A=r(98599),E='[cmdk-group=""]',I='[cmdk-group-items=""]',C='[cmdk-item=""]',R=`${C}:not([aria-disabled="true"])`,P="cmdk-item-select",M="data-value",D=(e,t,r)=>(function(e,t,r){return function e(t,r,s,a,n,l,i){if(l===r.length)return n===t.length?1:.99;var o=`${n},${l}`;if(void 0!==i[o])return i[o];for(var c,d,u,m,p=a.charAt(l),f=s.indexOf(p,n),h=0;f>=0;)(c=e(t,r,s,a,f+1,l+1,i))>h&&(f===n?c*=1:b.test(t.charAt(f-1))?(c*=.8,(u=t.slice(n,f-1).match(y))&&n>0&&(c*=Math.pow(.999,u.length))):j.test(t.charAt(f-1))?(c*=.9,(m=t.slice(n,f-1).match(w))&&n>0&&(c*=Math.pow(.999,m.length))):(c*=.17,n>0&&(c*=Math.pow(.999,f-n))),t.charAt(f)!==r.charAt(l)&&(c*=.9999)),(c<.1&&s.charAt(f-1)===a.charAt(l+1)||a.charAt(l+1)===a.charAt(l)&&s.charAt(f-1)!==a.charAt(l))&&.1*(d=e(t,r,s,a,f+1,l+2,i))>c&&(c=.1*d),c>h&&(h=c),f=s.indexOf(p,f+1);return i[o]=h,h}(e=r&&r.length>0?`${e+" "+r.join(" ")}`:e,t,N(e),N(t),0,0,{})})(e,t,r),_=a.createContext(void 0),$=()=>a.useContext(_),z=a.createContext(void 0),L=()=>a.useContext(z),B=a.createContext(void 0),F=a.forwardRef((e,t)=>{let r=W(()=>{var t,r;return{search:"",value:null!=(r=null!=(t=e.value)?t:e.defaultValue)?r:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),s=W(()=>new Set),n=W(()=>new Map),l=W(()=>new Map),i=W(()=>new Set),o=U(e),{label:c,children:d,value:u,onValueChange:m,filter:p,shouldFilter:f,loop:h,disablePointerSelection:x=!1,vimBindings:v=!0,...g}=e,b=(0,S.B)(),y=(0,S.B)(),j=(0,S.B)(),w=a.useRef(null),N=Q();Y(()=>{if(void 0!==u){let e=u.trim();r.current.value=e,k.emit()}},[u]),Y(()=>{N(6,G)},[]);let k=a.useMemo(()=>({subscribe:e=>(i.current.add(e),()=>i.current.delete(e)),snapshot:()=>r.current,setState:(e,t,s)=>{var a,n,l,i;if(!Object.is(r.current[e],t)){if(r.current[e]=t,"search"===e)F(),L(),N(1,B);else if("value"===e){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let e=document.getElementById(j);e?e.focus():null==(a=document.getElementById(b))||a.focus()}if(N(7,()=>{var e;r.current.selectedItemId=null==(e=T())?void 0:e.id,k.emit()}),s||N(5,G),(null==(n=o.current)?void 0:n.value)!==void 0){null==(i=(l=o.current).onValueChange)||i.call(l,null!=t?t:"");return}}k.emit()}},emit:()=>{i.current.forEach(e=>e())}}),[]),A=a.useMemo(()=>({value:(e,t,s)=>{var a;t!==(null==(a=l.current.get(e))?void 0:a.value)&&(l.current.set(e,{value:t,keywords:s}),r.current.filtered.items.set(e,$(t,s)),N(2,()=>{L(),k.emit()}))},item:(e,t)=>(s.current.add(e),t&&(n.current.has(t)?n.current.get(t).add(e):n.current.set(t,new Set([e]))),N(3,()=>{F(),L(),r.current.value||B(),k.emit()}),()=>{l.current.delete(e),s.current.delete(e),r.current.filtered.items.delete(e);let t=T();N(4,()=>{F(),(null==t?void 0:t.getAttribute("id"))===e&&B(),k.emit()})}),group:e=>(n.current.has(e)||n.current.set(e,new Set),()=>{l.current.delete(e),n.current.delete(e)}),filter:()=>o.current.shouldFilter,label:c||e["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:b,inputId:j,labelId:y,listInnerRef:w}),[]);function $(e,t){var s,a;let n=null!=(a=null==(s=o.current)?void 0:s.filter)?a:D;return e?n(e,r.current.search,t):0}function L(){if(!r.current.search||!1===o.current.shouldFilter)return;let e=r.current.filtered.items,t=[];r.current.filtered.groups.forEach(r=>{let s=n.current.get(r),a=0;s.forEach(t=>{a=Math.max(e.get(t),a)}),t.push([r,a])});let s=w.current;V().sort((t,r)=>{var s,a;let n=t.getAttribute("id"),l=r.getAttribute("id");return(null!=(s=e.get(l))?s:0)-(null!=(a=e.get(n))?a:0)}).forEach(e=>{let t=e.closest(I);t?t.appendChild(e.parentElement===t?e:e.closest(`${I} > *`)):s.appendChild(e.parentElement===s?e:e.closest(`${I} > *`))}),t.sort((e,t)=>t[1]-e[1]).forEach(e=>{var t;let r=null==(t=w.current)?void 0:t.querySelector(`${E}[${M}="${encodeURIComponent(e[0])}"]`);null==r||r.parentElement.appendChild(r)})}function B(){let e=V().find(e=>"true"!==e.getAttribute("aria-disabled")),t=null==e?void 0:e.getAttribute(M);k.setState("value",t||void 0)}function F(){var e,t,a,i;if(!r.current.search||!1===o.current.shouldFilter){r.current.filtered.count=s.current.size;return}r.current.filtered.groups=new Set;let c=0;for(let n of s.current){let s=$(null!=(t=null==(e=l.current.get(n))?void 0:e.value)?t:"",null!=(i=null==(a=l.current.get(n))?void 0:a.keywords)?i:[]);r.current.filtered.items.set(n,s),s>0&&c++}for(let[e,t]of n.current)for(let s of t)if(r.current.filtered.items.get(s)>0){r.current.filtered.groups.add(e);break}r.current.filtered.count=c}function G(){var e,t,r;let s=T();s&&((null==(e=s.parentElement)?void 0:e.firstChild)===s&&(null==(r=null==(t=s.closest(E))?void 0:t.querySelector('[cmdk-group-heading=""]'))||r.scrollIntoView({block:"nearest"})),s.scrollIntoView({block:"nearest"}))}function T(){var e;return null==(e=w.current)?void 0:e.querySelector(`${C}[aria-selected="true"]`)}function V(){var e;return Array.from((null==(e=w.current)?void 0:e.querySelectorAll(R))||[])}function O(e){let t=V()[e];t&&k.setState("value",t.getAttribute(M))}function K(e){var t;let r=T(),s=V(),a=s.findIndex(e=>e===r),n=s[a+e];null!=(t=o.current)&&t.loop&&(n=a+e<0?s[s.length-1]:a+e===s.length?s[0]:s[a+e]),n&&k.setState("value",n.getAttribute(M))}function H(e){let t=T(),r=null==t?void 0:t.closest(E),s;for(;r&&!s;)s=null==(r=e>0?function(e,t){let r=e.nextElementSibling;for(;r;){if(r.matches(t))return r;r=r.nextElementSibling}}(r,E):function(e,t){let r=e.previousElementSibling;for(;r;){if(r.matches(t))return r;r=r.previousElementSibling}}(r,E))?void 0:r.querySelector(R);s?k.setState("value",s.getAttribute(M)):K(e)}let J=()=>O(V().length-1),X=e=>{e.preventDefault(),e.metaKey?J():e.altKey?H(1):K(1)},Z=e=>{e.preventDefault(),e.metaKey?O(0):e.altKey?H(-1):K(-1)};return a.createElement(q.sG.div,{ref:t,tabIndex:-1,...g,"cmdk-root":"",onKeyDown:e=>{var t;null==(t=g.onKeyDown)||t.call(g,e);let r=e.nativeEvent.isComposing||229===e.keyCode;if(!(e.defaultPrevented||r))switch(e.key){case"n":case"j":v&&e.ctrlKey&&X(e);break;case"ArrowDown":X(e);break;case"p":case"k":v&&e.ctrlKey&&Z(e);break;case"ArrowUp":Z(e);break;case"Home":e.preventDefault(),O(0);break;case"End":e.preventDefault(),J();break;case"Enter":{e.preventDefault();let t=T();if(t){let e=new Event(P);t.dispatchEvent(e)}}}}},a.createElement("label",{"cmdk-label":"",htmlFor:A.inputId,id:A.labelId,style:et},c),ee(e,e=>a.createElement(z.Provider,{value:k},a.createElement(_.Provider,{value:A},e))))}),G=a.forwardRef((e,t)=>{var r,s;let n=(0,S.B)(),l=a.useRef(null),i=a.useContext(B),o=$(),c=U(e),d=null!=(s=null==(r=c.current)?void 0:r.forceMount)?s:null==i?void 0:i.forceMount;Y(()=>{if(!d)return o.item(n,null==i?void 0:i.id)},[d]);let u=Z(n,l,[e.value,e.children,l],e.keywords),m=L(),p=X(e=>e.value&&e.value===u.current),f=X(e=>!!d||!1===o.filter()||!e.search||e.filtered.items.get(n)>0);function h(){var e,t;x(),null==(t=(e=c.current).onSelect)||t.call(e,u.current)}function x(){m.setState("value",u.current,!0)}if(a.useEffect(()=>{let t=l.current;if(!(!t||e.disabled))return t.addEventListener(P,h),()=>t.removeEventListener(P,h)},[f,e.onSelect,e.disabled]),!f)return null;let{disabled:v,value:g,onSelect:b,forceMount:y,keywords:j,...w}=e;return a.createElement(q.sG.div,{ref:(0,A.t)(l,t),...w,id:n,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!p,"data-disabled":!!v,"data-selected":!!p,onPointerMove:v||o.getDisablePointerSelection()?void 0:x,onClick:v?void 0:h},e.children)}),T=a.forwardRef((e,t)=>{let{heading:r,children:s,forceMount:n,...l}=e,i=(0,S.B)(),o=a.useRef(null),c=a.useRef(null),d=(0,S.B)(),u=$(),m=X(e=>!!n||!1===u.filter()||!e.search||e.filtered.groups.has(i));Y(()=>u.group(i),[]),Z(i,o,[e.value,e.heading,c]);let p=a.useMemo(()=>({id:i,forceMount:n}),[n]);return a.createElement(q.sG.div,{ref:(0,A.t)(o,t),...l,"cmdk-group":"",role:"presentation",hidden:!m||void 0},r&&a.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:d},r),ee(e,e=>a.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?d:void 0},a.createElement(B.Provider,{value:p},e))))}),V=a.forwardRef((e,t)=>{let{alwaysRender:r,...s}=e,n=a.useRef(null),l=X(e=>!e.search);return r||l?a.createElement(q.sG.div,{ref:(0,A.t)(n,t),...s,"cmdk-separator":"",role:"separator"}):null}),O=a.forwardRef((e,t)=>{let{onValueChange:r,...s}=e,n=null!=e.value,l=L(),i=X(e=>e.search),o=X(e=>e.selectedItemId),c=$();return a.useEffect(()=>{null!=e.value&&l.setState("search",e.value)},[e.value]),a.createElement(q.sG.input,{ref:t,...s,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":o,id:c.inputId,type:"text",value:n?e.value:i,onChange:e=>{n||l.setState("search",e.target.value),null==r||r(e.target.value)}})}),K=a.forwardRef((e,t)=>{let{children:r,label:s="Suggestions",...n}=e,l=a.useRef(null),i=a.useRef(null),o=X(e=>e.selectedItemId),c=$();return a.useEffect(()=>{if(i.current&&l.current){let e=i.current,t=l.current,r,s=new ResizeObserver(()=>{r=requestAnimationFrame(()=>{let r=e.offsetHeight;t.style.setProperty("--cmdk-list-height",r.toFixed(1)+"px")})});return s.observe(e),()=>{cancelAnimationFrame(r),s.unobserve(e)}}},[]),a.createElement(q.sG.div,{ref:(0,A.t)(l,t),...n,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":o,"aria-label":s,id:c.listId},ee(e,e=>a.createElement("div",{ref:(0,A.t)(i,c.listInnerRef),"cmdk-list-sizer":""},e)))}),H=a.forwardRef((e,t)=>{let{open:r,onOpenChange:s,overlayClassName:n,contentClassName:l,container:i,...o}=e;return a.createElement(k.bL,{open:r,onOpenChange:s},a.createElement(k.ZL,{container:i},a.createElement(k.hJ,{"cmdk-overlay":"",className:n}),a.createElement(k.UC,{"aria-label":e.label,"cmdk-dialog":"",className:l},a.createElement(F,{ref:t,...o}))))}),J=Object.assign(F,{List:K,Item:G,Input:O,Group:T,Separator:V,Dialog:H,Empty:a.forwardRef((e,t)=>X(e=>0===e.filtered.count)?a.createElement(q.sG.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),Loading:a.forwardRef((e,t)=>{let{progress:r,children:s,label:n="Loading...",...l}=e;return a.createElement(q.sG.div,{ref:t,...l,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":n},ee(e,e=>a.createElement("div",{"aria-hidden":!0},e)))})});function U(e){let t=a.useRef(e);return Y(()=>{t.current=e}),t}var Y=a.useEffect;function W(e){let t=a.useRef();return void 0===t.current&&(t.current=e()),t}function X(e){let t=L(),r=()=>e(t.snapshot());return a.useSyncExternalStore(t.subscribe,r,r)}function Z(e,t,r,s=[]){let n=a.useRef(),l=$();return Y(()=>{var a;let i=(()=>{var e;for(let t of r){if("string"==typeof t)return t.trim();if("object"==typeof t&&"current"in t)return t.current?null==(e=t.current.textContent)?void 0:e.trim():n.current}})(),o=s.map(e=>e.trim());l.value(e,i,o),null==(a=t.current)||a.setAttribute(M,i),n.current=i}),n}var Q=()=>{let[e,t]=a.useState(),r=W(()=>new Map);return Y(()=>{r.current.forEach(e=>e()),r.current=new Map},[e]),(e,s)=>{r.current.set(e,s),t({})}};function ee({asChild:e,children:t},r){let s;return e&&a.isValidElement(t)?a.cloneElement("function"==typeof(s=t.type)?s(t.props):"render"in s?s.render(t.props):t,{ref:t.ref},r(t.props.children)):r(t)}var et={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"},er=r(41936),es=r(4780);r(63503);let ea=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(J,{ref:r,className:(0,es.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));ea.displayName=J.displayName;let en=a.forwardRef(({className:e,...t},r)=>(0,s.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,s.jsx)(er.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,s.jsx)(J.Input,{ref:r,className:(0,es.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));en.displayName=J.Input.displayName;let el=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(J.List,{ref:r,className:(0,es.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));el.displayName=J.List.displayName;let ei=a.forwardRef((e,t)=>(0,s.jsx)(J.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));ei.displayName=J.Empty.displayName;let eo=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(J.Group,{ref:r,className:(0,es.cn)("overflow-hidden p-1 text-popover-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));eo.displayName=J.Group.displayName,a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(J.Separator,{ref:r,className:(0,es.cn)("-mx-1 h-px bg-border",e),...t})).displayName=J.Separator.displayName;let ec=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(J.Item,{ref:r,className:(0,es.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t}));ec.displayName=J.Item.displayName;var ed=r(73437),eu=r(35265),em=r(26622),ep=r(82614);let ef=(0,ep.A)("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);var eh=r(58450),ex=r(57207),ev=r(11516);let eg=(0,ep.A)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var eb=r(24555),ey=r(14975),ej=r(29867),ew=r(6475);let eN=(0,ew.createServerReference)("40c953ede8c138aa92e972c1604f4839ba54397e62",ew.callServer,void 0,ew.findSourceMapURL,"generateSalesNotification"),ek=o.Ik({productName:o.Yj().min(1,{message:"Please select a product."}),productId:o.Yj().min(1,{message:"Please select a batch."}),quantity:o.au.number().min(1,"Quantity must be at least 1."),price:o.au.number().optional()}),eq=o.Ik({saleDate:o.p6({required_error:"A sale date is required."}),customerName:o.Yj().min(1,"Please select a customer."),items:o.YO(ek).min(1,"Please add at least one product.")});function eS(){let{products:e,addBulkSale:t,customers:r}=(0,c.n)(),{toast:a}=(0,ej.dj)(),[o,b]=n().useState(null),[y,j]=n().useState({isLoading:!1,message:null,error:null}),[w,N]=n().useState(!1),k=(0,l.mN)({resolver:(0,i.u)(eq),defaultValues:{saleDate:new Date,customerName:"",items:[{productName:"",productId:"",quantity:1,price:0}]}}),{fields:q,append:S,remove:A}=(0,l.jz)({control:k.control,name:"items"}),E=n().useMemo(()=>[...new Set(e.map(e=>e.name))],[e]),I=k.watch("items").map(e=>e.productName),C=async()=>{if(o){j({isLoading:!0,message:null,error:null});try{let e=await eN({customerName:o.customerName,items:o.items.map(e=>({productName:e.productName,quantity:e.quantity,price:e.price})),totalAmount:o.totalAmount});j({isLoading:!1,message:e.notificationMessage,error:null})}catch(e){console.error(e),j({isLoading:!1,message:null,error:"Failed to generate notification."})}}};async function R(r){let s=!1,n=r.items.map(e=>e.productId),l=n.filter((e,t)=>n.indexOf(e)!==t&&""!==e);if(l.length>0&&r.items.forEach((e,t)=>{l.includes(e.productId)&&(k.setError(`items.${t}.productId`,{type:"manual",message:"Duplicate batch selected."}),s=!0)}),r.items.forEach((t,r)=>{let a=e.find(e=>e.id===t.productId);a&&a.stockInHand<t.quantity&&(k.setError(`items.${r}.quantity`,{type:"manual",message:`Not enough stock. Only ${a.stockInHand} available.`}),s=!0)}),!s)try{await t({customerName:r.customerName,saleDate:r.saleDate,items:r.items.map(t=>({productId:t.productId,quantity:t.quantity,price:e.find(e=>e.id===t.productId).price}))});let s=r.items.map(t=>{let r=e.find(e=>e.id===t.productId);return{productName:r.name,quantity:t.quantity,price:r.price,total:t.quantity*r.price}}),n=s.reduce((e,t)=>e+t.total,0);b({customerName:r.customerName,items:s,totalAmount:n}),j({isLoading:!1,message:null,error:null});let l=r.items.reduce((e,t)=>e+t.quantity,0);a({title:"Sales Recorded Successfully",description:`Recorded sales for ${r.items.length} product(s), totaling ${l} items for ${r.customerName}.`}),k.reset({saleDate:new Date,customerName:"",items:[{productName:"",productId:"",quantity:1,price:0}]})}catch(e){a({variant:"destructive",title:"Failed to Record Sale",description:e.message||"An unexpected error occurred."})}}return(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-8 items-start",children:[(0,s.jsxs)(u.Zp,{className:"lg:col-span-3",children:[(0,s.jsxs)(u.aR,{children:[(0,s.jsxs)(u.ZB,{className:"flex items-center gap-2",children:[(0,s.jsx)(eu.A,{}),"Record Sales"]}),(0,s.jsx)(u.BT,{children:"Add one or more products to record a bulk sale for a single customer. The inventory will be updated automatically."})]}),(0,s.jsx)(u.Wu,{children:(0,s.jsx)(m.lV,{...k,children:(0,s.jsxs)("form",{onSubmit:k.handleSubmit(R),className:"space-y-8",children:[(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-4 max-w-2xl",children:[(0,s.jsx)(m.zB,{control:k.control,name:"saleDate",render:({field:e})=>(0,s.jsxs)(m.eI,{className:"flex flex-col",children:[(0,s.jsx)(m.lR,{children:"Date of Sale"}),(0,s.jsxs)(f.AM,{children:[(0,s.jsx)(f.Wv,{asChild:!0,children:(0,s.jsx)(m.MJ,{children:(0,s.jsxs)(d.$,{variant:"outline",className:(0,es.cn)("w-full pl-3 text-left font-normal",!e.value&&"text-muted-foreground"),children:[e.value?(0,ed.GP)(e.value,"PPP"):(0,s.jsx)("span",{children:"Pick a date"}),(0,s.jsx)(em.A,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),(0,s.jsx)(f.hl,{className:"w-auto p-0",align:"start",children:(0,s.jsx)(h.V,{mode:"single",selected:e.value,onSelect:e.onChange,disabled:e=>e>new Date||e<new Date("1900-01-01"),initialFocus:!0})})]}),(0,s.jsx)(m.C5,{})]})}),(0,s.jsx)(m.zB,{control:k.control,name:"customerName",render:({field:e})=>(0,s.jsxs)(m.eI,{className:"flex flex-col",children:[(0,s.jsx)(m.lR,{children:"Customer Name"}),(0,s.jsxs)(f.AM,{open:w,onOpenChange:N,children:[(0,s.jsx)(f.Wv,{asChild:!0,children:(0,s.jsx)(m.MJ,{children:(0,s.jsxs)(d.$,{variant:"outline",role:"combobox",className:(0,es.cn)("w-full justify-between",!e.value&&"text-muted-foreground"),children:[e.value?r.find(t=>t.name===e.value)?.name:"Select a customer",(0,s.jsx)(ef,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),(0,s.jsx)(f.hl,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",children:(0,s.jsxs)(ea,{children:[(0,s.jsx)(en,{placeholder:"Search customers..."}),(0,s.jsxs)(el,{children:[(0,s.jsx)(ei,{children:"No customer found."}),(0,s.jsx)(eo,{children:r.map(t=>(0,s.jsxs)(ec,{value:t.name,onSelect:()=>{k.setValue("customerName",t.name),N(!1)},children:[(0,s.jsx)(eh.A,{className:(0,es.cn)("mr-2 h-4 w-4",t.name===e.value?"opacity-100":"opacity-0")}),t.name]},t.id))})]})]})})]}),(0,s.jsx)(m.C5,{})]})})]}),(0,s.jsx)("div",{className:"space-y-4",children:q.map((t,r)=>{let a=k.watch(`items.${r}.productName`),n=e.filter(e=>e.name===a);return(0,s.jsxs)("div",{className:"flex items-start gap-4 p-4 border rounded-lg",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 flex-1",children:[(0,s.jsx)(m.zB,{control:k.control,name:`items.${r}.productName`,render:({field:e})=>(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Product"}),(0,s.jsxs)(x.l6,{onValueChange:t=>{e.onChange(t),k.setValue(`items.${r}.productId`,""),k.setValue(`items.${r}.price`,0),k.clearErrors(`items.${r}.productId`)},value:e.value,children:[(0,s.jsx)(m.MJ,{children:(0,s.jsx)(x.bq,{children:(0,s.jsx)(x.yv,{placeholder:"Select a product"})})}),(0,s.jsx)(x.gC,{children:E.map(t=>(0,s.jsx)(x.eb,{value:t,disabled:I.includes(t)&&e.value!==t,children:t},t))})]}),(0,s.jsx)(m.C5,{})]})}),(0,s.jsx)(m.zB,{control:k.control,name:`items.${r}.productId`,render:({field:t})=>(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Batch Number"}),(0,s.jsxs)(x.l6,{onValueChange:s=>{t.onChange(s);let a=e.find(e=>e.id===s);k.setValue(`items.${r}.price`,a?.price)},value:t.value,disabled:!a,children:[(0,s.jsx)(m.MJ,{children:(0,s.jsx)(x.bq,{children:(0,s.jsx)(x.yv,{placeholder:"Select a batch"})})}),(0,s.jsx)(x.gC,{children:n.map(e=>(0,s.jsxs)(x.eb,{value:e.id,disabled:0===e.stockInHand,children:[e.batchNumber," (",e.stockInHand," in stock)"]},e.id))})]}),(0,s.jsx)(m.C5,{})]})}),(0,s.jsx)(m.zB,{control:k.control,name:`items.${r}.quantity`,render:({field:e})=>(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Quantity"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(p.p,{type:"number",placeholder:"1",...e})}),(0,s.jsx)(m.C5,{})]})}),(0,s.jsx)(m.zB,{control:k.control,name:`items.${r}.price`,render:({field:e})=>(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Price (₹)"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(p.p,{type:"number",placeholder:"0.00",disabled:!0,value:e.value||0})}),(0,s.jsx)(m.C5,{})]})})]}),(0,s.jsxs)(d.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>A(r),disabled:q.length<=1,className:"mt-8 text-destructive hover:bg-destructive/10",children:[(0,s.jsx)(ex.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Remove item"})]})]},t.id)})}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)(d.$,{type:"button",variant:"outline",onClick:()=>S({productName:"",productId:"",quantity:1,price:0}),children:[(0,s.jsx)(eu.A,{className:"mr-2 h-4 w-4"}),"Add Another Product"]}),(0,s.jsx)(d.$,{type:"submit",disabled:k.formState.isSubmitting,children:k.formState.isSubmitting?"Recording Sales...":"Record All Sales"})]})]})})})]}),(0,s.jsx)("div",{className:"lg:col-span-2 space-y-4",children:o&&(0,s.jsxs)(u.Zp,{children:[(0,s.jsxs)(u.aR,{children:[(0,s.jsx)(u.ZB,{children:"Sale Summary"}),(0,s.jsxs)(u.BT,{children:["For customer: ",(0,s.jsx)("strong",{children:o.customerName})]})]}),(0,s.jsxs)(u.Wu,{children:[(0,s.jsxs)(v.XI,{children:[(0,s.jsx)(v.A0,{children:(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nd,{children:"Item"}),(0,s.jsx)(v.nd,{className:"text-center",children:"Qty"}),(0,s.jsx)(v.nd,{className:"text-right",children:"Total"})]})}),(0,s.jsx)(v.BF,{children:o.items.map((e,t)=>(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:e.productName}),(0,s.jsx)(v.nA,{className:"text-center",children:e.quantity}),(0,s.jsxs)(v.nA,{className:"text-right",children:["₹",e.total.toFixed(2)]})]},t))})]}),(0,s.jsxs)("div",{className:"text-right font-bold text-lg mt-4",children:["Grand Total: ₹",o.totalAmount.toFixed(2)]})]}),(0,s.jsxs)(u.wL,{className:"flex flex-col items-stretch gap-4",children:[(0,s.jsxs)(d.$,{onClick:C,disabled:y.isLoading,children:[y.isLoading?(0,s.jsx)(ev.A,{className:"animate-spin"}):(0,s.jsx)(eg,{}),"Send Bill Notification"]}),y.message&&(0,s.jsxs)(g.Fc,{variant:"default",className:"bg-primary/10",children:[(0,s.jsx)(eb.A,{className:"h-4 w-4 text-primary"}),(0,s.jsx)(g.XL,{className:"text-primary",children:"Generated Notification"}),(0,s.jsx)(g.TN,{className:"whitespace-pre-wrap",children:y.message})]}),y.error&&(0,s.jsxs)(g.Fc,{variant:"destructive",children:[(0,s.jsx)(ey.A,{className:"h-4 w-4"}),(0,s.jsx)(g.XL,{children:"Error"}),(0,s.jsx)(g.TN,{children:y.error})]})]})]})})]})}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14057:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"D:\\\\Inventory Mgmt\\\\studio\\\\src\\\\components\\\\pages\\\\sales.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\Inventory Mgmt\\studio\\src\\components\\pages\\sales.tsx","default")},16141:e=>{"use strict";e.exports=require("node:zlib")},16698:e=>{"use strict";e.exports=require("node:async_hooks")},19063:e=>{"use strict";e.exports=require("require-in-the-middle")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28210:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c});var s=r(65239),a=r(48088),n=r(88170),l=r.n(n),i=r(30893),o={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);r.d(t,o);let c={children:["",{children:["sales",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,43227)),"D:\\Inventory Mgmt\\studio\\src\\app\\sales\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"D:\\Inventory Mgmt\\studio\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["D:\\Inventory Mgmt\\studio\\src\\app\\sales\\page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/sales/page",pathname:"/sales",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34235:(e,t,r)=>{"use strict";r.r(t),r.d(t,{"40c953ede8c138aa92e972c1604f4839ba54397e62":()=>d});var s=r(91199);r(42087);var a=r(95427),n=r(37612),l=r(33331);let i=n.z.object({productName:n.z.string().describe("The name of the product purchased."),quantity:n.z.number().describe("The quantity of the product purchased."),price:n.z.number().describe("The price per unit of the product.")}),o=n.z.object({customerName:n.z.string().describe("The customer's name."),items:n.z.array(i).describe("An array of items included in the sale."),totalAmount:n.z.number().describe("The total amount of the bill.")}),c=n.z.object({notificationMessage:n.z.string().describe("A friendly notification message for the customer summarizing their bill.")});async function d(e){return m(e)}let u=a.ai.definePrompt({name:"generateSalesNotificationPrompt",input:{schema:o},output:{schema:c},prompt:`You are a friendly shop assistant for a veterinary supply store. Generate a concise and friendly notification message for a customer confirming their recent purchase.

- Address the customer by name.
- List each item they purchased with its quantity.
- State the total amount of the bill clearly.
- Keep the tone professional but warm and thank them for their business.

Customer Name: {{customerName}}
Total Bill: ₹{{totalAmount}}
Items Purchased:
{{#each items}}
- {{this.productName}} (Quantity: {{this.quantity}})
{{/each}}
`}),m=a.ai.defineFlow({name:"generateSalesNotificationFlow",inputSchema:o,outputSchema:c},async e=>{let{output:t}=await u(e);return t});(0,l.D)([d]),(0,s.A)(d,"40c953ede8c138aa92e972c1604f4839ba54397e62",null)},34631:e=>{"use strict";e.exports=require("tls")},35265:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},37067:e=>{"use strict";e.exports=require("node:http")},37366:e=>{"use strict";e.exports=require("dns")},37830:e=>{"use strict";e.exports=require("node:stream/web")},43227:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var s=r(37413),a=r(14057);function n(){return(0,s.jsx)(a.default,{})}},44708:e=>{"use strict";e.exports=require("node:https")},47002:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=47002,e.exports=t},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},56801:e=>{"use strict";e.exports=require("import-in-the-middle")},57075:e=>{"use strict";e.exports=require("node:stream")},57975:e=>{"use strict";e.exports=require("node:util")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},69337:(e,t,r)=>{Promise.resolve().then(r.bind(r,10029))},73024:e=>{"use strict";e.exports=require("node:fs")},73136:e=>{"use strict";e.exports=require("node:url")},73496:e=>{"use strict";e.exports=require("http2")},73566:e=>{"use strict";e.exports=require("worker_threads")},74075:e=>{"use strict";e.exports=require("zlib")},74998:e=>{"use strict";e.exports=require("perf_hooks")},76760:e=>{"use strict";e.exports=require("node:path")},77030:e=>{"use strict";e.exports=require("node:net")},77598:e=>{"use strict";e.exports=require("node:crypto")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},79646:e=>{"use strict";e.exports=require("child_process")},79748:e=>{"use strict";e.exports=require("fs/promises")},81630:e=>{"use strict";e.exports=require("http")},82361:(e,t,r)=>{Promise.resolve().then(r.bind(r,14057))},84297:e=>{"use strict";e.exports=require("async_hooks")},91645:e=>{"use strict";e.exports=require("net")},91821:(e,t,r)=>{"use strict";r.d(t,{Fc:()=>o,TN:()=>d,XL:()=>c});var s=r(60687),a=r(43210),n=r(24224),l=r(4780);let i=(0,n.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=a.forwardRef(({className:e,variant:t,...r},a)=>(0,s.jsx)("div",{ref:a,role:"alert",className:(0,l.cn)(i({variant:t}),e),...r}));o.displayName="Alert";let c=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("h5",{ref:r,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",e),...t}));c.displayName="AlertTitle";let d=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",e),...t}));d.displayName="AlertDescription"},94735:e=>{"use strict";e.exports=require("events")},95427:(e,t,r)=>{"use strict";r.d(t,{ai:()=>n});var s=r(37612),a=r(56758);let n=(0,s.genkit)({plugins:[(0,a.YF)()],model:"googleai/gemini-2.0-flash"})}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,120,658,758,58,34,827,763],()=>r(28210));module.exports=s})();